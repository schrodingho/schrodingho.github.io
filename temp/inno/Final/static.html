

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  
    <meta name="description" content="Schrodingho&#39;s Blog">
  
  <meta name="author" content="Schrodingho">
  <meta name="keywords" content="">
  
  <title>page.title - BBQzone</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.4.0/styles/github-gist.min.css" />
    
  

  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"schrodingho.github.io","root":"/","version":"1.8.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"onlypost":false},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}}};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
  <header style="height: 60vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>BBQzone</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="page.title">
              
            </span>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      <div class="container nopadding-x-md">
        <div class="py-5" id="board"
          >
          
          <div class="container">
            <div class="row">
              <div class="col-12 col-md-10 m-auto">
                

<article class="page-content">
  <h1 id="回测引擎：初始化函数，只执行一次"><a href="#回测引擎：初始化函数，只执行一次" class="headerlink" title="回测引擎：初始化函数，只执行一次"></a>回测引擎：初始化函数，只执行一次</h1><p>def bigquant_run(context):</p>
<pre><code># 加载预测数据
context.ranker_prediction = context.options[&#39;data&#39;].read_df()

# 系统已经设置了默认的交易手续费和滑点，要修改手续费可使用如下函数
context.set_commission(PerOrder(buy_cost=0.0003, sell_cost=0.0013, min_cost=5))
# 预测数据，通过options传入进来，使用 read_df 函数，加载到内存 (DataFrame)
# 设置买入的股票数量，这里买入预测股票列表排名靠前的5只
stock_count = 5
# 每只的股票的权重，如下的权重分配会使得靠前的股票分配多一点的资金，[0.339160, 0.213986, 0.169580, ..]
context.stock_weights = T.norm([1 / math.log(i + 2) for i in range(0, stock_count)])
# 设置每只股票占用的最大资金比例
context.max_cash_per_instrument = 0.2
context.options[&#39;hold_days&#39;] = 5
</code></pre><h1 id="回测引擎：每日数据处理函数，每天执行一次"><a href="#回测引擎：每日数据处理函数，每天执行一次" class="headerlink" title="回测引擎：每日数据处理函数，每天执行一次"></a>回测引擎：每日数据处理函数，每天执行一次</h1><p>def bigquant_run(context, data):</p>
<pre><code># 按日期过滤得到今日的预测数据
ranker_prediction = context.ranker_prediction[
    context.ranker_prediction.date == data.current_dt.strftime(&#39;%Y-%m-%d&#39;)]

# 1. 资金分配
# 平均持仓时间是hold_days，每日都将买入股票，每日预期使用 1/hold_days 的资金
# 实际操作中，会存在一定的买入误差，所以在前hold_days天，等量使用资金；之后，尽量使用剩余资金（这里设置最多用等量的1.5倍）
is_staging = context.trading_day_index &lt; context.options[&#39;hold_days&#39;] # 是否在建仓期间（前 hold_days 天）
cash_avg = context.portfolio.portfolio_value / context.options[&#39;hold_days&#39;]
cash_for_buy = min(context.portfolio.cash, (1 if is_staging else 1.5) * cash_avg)
cash_for_sell = cash_avg - (context.portfolio.cash - cash_for_buy)
positions = &#123;e.symbol: p.amount * p.last_sale_price
             for e, p in context.perf_tracker.position_tracker.positions.items()&#125;

# 2. 生成卖出订单：hold_days天之后才开始卖出；对持仓的股票，按机器学习算法预测的排序末位淘汰
if not is_staging and cash_for_sell &gt; 0:
    equities = &#123;e.symbol: e for e, p in context.perf_tracker.position_tracker.positions.items()&#125;
    instruments = list(reversed(list(ranker_prediction.instrument[ranker_prediction.instrument.apply(
            lambda x: x in equities and not context.has_unfinished_sell_order(equities[x]))])))
    # print(&#39;rank order for sell %s&#39; % instruments)
    for instrument in instruments:
        context.order_target(context.symbol(instrument), 0)
        cash_for_sell -= positions[instrument]
        if cash_for_sell &lt;= 0:
            break

# 3. 生成买入订单：按机器学习算法预测的排序，买入前面的stock_count只股票
buy_cash_weights = context.stock_weights
buy_instruments = list(ranker_prediction.instrument[:len(buy_cash_weights)])
max_cash_per_instrument = context.portfolio.portfolio_value * context.max_cash_per_instrument
for i, instrument in enumerate(buy_instruments):
    cash = cash_for_buy * buy_cash_weights[i]
    if cash &gt; max_cash_per_instrument - positions.get(instrument, 0):
        # 确保股票持仓量不会超过每次股票最大的占用资金量
        cash = max_cash_per_instrument - positions.get(instrument, 0)
    if cash &gt; 0:
        context.order_value(context.symbol(instrument), cash)
</code></pre><h1 id="特征"><a href="#特征" class="headerlink" title="特征"></a>特征</h1><p>return_5  收益率<br>return_10<br>return_20<br>avg_amount_5/avg_amount_10 平均交易量<br>return_5/return_10<br>ta_cci_14_0 CCI指标<br>turn_5/avg_turn_10 平均换手率<br>avg_amount_0/avg_amount_5<br>swing_volatility_5_0/swing_volatility_60_0 振幅波动率<br>amount_10/amount_30 总交易量<br>rank_volatility_10_0 波动率<br>return_0<br>ta_ema_5_0/close_0 指数移动平均值<br>close_0/low_0<br>ta_ema_20_0/close_0<br>open_0/close_1<br>high_1/close_0<br>ta_ema_30_0/close_0<br>ta_rsi(close_0, 6) RSI指标<br>amount_0/amount_1<br>pb_lf_0 市净率 市盈率</p>
<p>market_cap_0<br>market_cap_float_0<br>fs_gross_revenues_0<br>fs_eqy_belongto_parcomsh_0<br>fs_net_income_0/fs_gross_revenues_0<br>fs_net_profit_margin_0<br>fs_operating_profit_0/fs_gross_revenues_0<br>fs_net_income_0<br>fs_cash_ratio_0<br>fs_account_receivable_0<br>fs_operating_revenue_ttm_0/(fs_total_liability_0+fs_total_equity_0)<br>fs_net_cash_flow_0/fs_paicl_up_capital_0<br>fs_operating_profit_0/fs_paicl_up_capital_0<br>fs_net_profit_yoy_0/pe_ttm_0<br>ta_sma_5_0<br>std(turn_0,5)<br>ta_bbi(close, ‘short’)<br>ta_roc(x,20)<br>ta_bias(close,5)</p>
<p>def m4_run_bigquant_run(input_1, input_2, input_3):<br>    df =  input_1.read_pickle()<br>    feature_len = len(input_2.read_pickle())<br>    df[‘x’] = df[‘x’].reshape(df[‘x’].shape[0], int(feature_len), int(df[‘x’].shape[1]/feature_len))<br>    data_1 = DataSource.write_pickle(df)<br>    return Outputs(data_1=data_1)</p>
<p>def m4_post_run_bigquant_run(outputs):<br>    return outputs</p>
<p>def m8_run_bigquant_run(input_1, input_2, input_3):</p>
<pre><code># 示例代码如下。在这里编写您的代码
df =  input_1.read_pickle()
feature_len = len(input_2.read_pickle())
df[&#39;x&#39;] = df[&#39;x&#39;].reshape(df[&#39;x&#39;].shape[0], int(feature_len), int(df[&#39;x&#39;].shape[1]/feature_len))
data_1 = DataSource.write_pickle(df)
return Outputs(data_1=data_1)
</code></pre><p>def m8_post_run_bigquant_run(outputs):<br>    return outputs<br>bigquant_run = {</p>
<p>}</p>
<p>def m24_run_bigquant_run(input_1, input_2, input_3):</p>
<pre><code># 示例代码如下。在这里编写您的代码
pred_label = input_1.read_pickle()
df = input_2.read_df()
df = pd.DataFrame(&#123;&#39;pred_label&#39;:pred_label[:,0], &#39;instrument&#39;:df.instrument, &#39;date&#39;:df.date&#125;)
df.sort_values([&#39;date&#39;,&#39;pred_label&#39;],inplace=True, ascending=[True,False])
return Outputs(data_1=DataSource.write_df(df), data_2=None, data_3=None)
</code></pre><p>def m24_post_run_bigquant_run(outputs):<br>    return outputs</p>
<h1 id="回测引擎：初始化函数，只执行一次-1"><a href="#回测引擎：初始化函数，只执行一次-1" class="headerlink" title="回测引擎：初始化函数，只执行一次"></a>回测引擎：初始化函数，只执行一次</h1><p>def m19_initialize_bigquant_run(context):</p>
<pre><code># 加载预测数据
context.ranker_prediction = context.options[&#39;data&#39;].read_df()
context.set_commission(PerOrder(buy_cost=0.0003, sell_cost=0.0013, min_cost=5))
stock_count = 5
context.stock_weights = T.norm([1 / math.log(i + 2) for i in range(0, stock_count)])
context.max_cash_per_instrument = 0.2
context.options[&#39;hold_days&#39;] = 5
</code></pre><h1 id="回测引擎：每日数据处理函数，每天执行一次-1"><a href="#回测引擎：每日数据处理函数，每天执行一次-1" class="headerlink" title="回测引擎：每日数据处理函数，每天执行一次"></a>回测引擎：每日数据处理函数，每天执行一次</h1><p>def m19_handle_data_bigquant_run(context, data):</p>
<pre><code># 按日期过滤得到今日的预测数据
ranker_prediction = context.ranker_prediction[
    context.ranker_prediction.date == data.current_dt.strftime(&#39;%Y-%m-%d&#39;)]

is_staging = context.trading_day_index &lt; context.options[&#39;hold_days&#39;] # 是否在建仓期间（前 hold_days 天）
cash_avg = context.portfolio.portfolio_value / context.options[&#39;hold_days&#39;]
cash_for_buy = min(context.portfolio.cash, (1 if is_staging else 1.5) * cash_avg)
cash_for_sell = cash_avg - (context.portfolio.cash - cash_for_buy)
positions = &#123;e.symbol: p.amount * p.last_sale_price
             for e, p in context.perf_tracker.position_tracker.positions.items()&#125;

if not is_staging and cash_for_sell &gt; 0:
    equities = &#123;e.symbol: e for e, p in context.perf_tracker.position_tracker.positions.items()&#125;
    instruments = list(reversed(list(ranker_prediction.instrument[ranker_prediction.instrument.apply(
            lambda x: x in equities and not context.has_unfinished_sell_order(equities[x]))])))
    # print(&#39;rank order for sell %s&#39; % instruments)
    for instrument in instruments:
        context.order_target(context.symbol(instrument), 0)
        cash_for_sell -= positions[instrument]
        if cash_for_sell &lt;= 0:
            break


buy_cash_weights = context.stock_weights
buy_instruments = list(ranker_prediction.instrument[:len(buy_cash_weights)])
max_cash_per_instrument = context.portfolio.portfolio_value * context.max_cash_per_instrument
for i, instrument in enumerate(buy_instruments):
    cash = cash_for_buy * buy_cash_weights[i]
    if cash &gt; max_cash_per_instrument - positions.get(instrument, 0):
        # 确保股票持仓量不会超过每次股票最大的占用资金量
        cash = max_cash_per_instrument - positions.get(instrument, 0)
    if cash &gt; 0:
        context.order_value(context.symbol(instrument), cash)
</code></pre><p>def m19_prepare_bigquant_run(context):<br>    pass</p>
<p>m1 = M.instruments.v2(<br>    start_date=’2020-04-01’,<br>    end_date=’2021-04-30’,<br>    market=’CN_STOCK_A’,<br>    instrument_list=’ ‘,<br>    max_count=0<br>)</p>
<p>m2 = M.advanced_auto_labeler.v2(<br>    instruments=m1.data,<br>    label_expr=”””</p>
<p>clip(label, all_quantile(label, 0.01), all_quantile(label, 0.99))</p>
<p>where(shift(high, -1) == shift(low, -1), NaN, label)<br>“””,<br>    start_date=’’,<br>    end_date=’’,<br>    benchmark=’000300.SHA’,<br>    drop_na_label=True,<br>    cast_label_int=False<br>)</p>
<p>m13 = M.standardlize.v8(<br>    input_1=m2.data,<br>    columns_input=’label’<br>)</p>
<p>m3 = M.input_features.v1(<br>    features=”””return_5<br>return_10<br>return_20<br>avg_amount_5/avg_amount_10<br>return_5/return_10<br>ta_cci_14_0<br>turn_5/avg_turn_10<br>avg_amount_0/avg_amount_5<br>swing_volatility_5_0/swing_volatility_60_0<br>amount_10/amount_30<br>rank_volatility_10_0<br>return_0<br>ta_ema_5_0/close_0<br>close_0/low_0<br>ta_ema_20_0/close_0<br>open_0/close_1<br>high_1/close_0<br>ta_ema_30_0/close_0<br>ta_rsi(close_0, 6)<br>amount_0/amount_1<br>pb_lf_0”””<br>)</p>
<p>m15 = M.general_feature_extractor.v7(<br>    instruments=m1.data,<br>    features=m3.data,<br>    start_date=’’,<br>    end_date=’’,<br>    before_start_days=30<br>)</p>
<p>m16 = M.derived_feature_extractor.v3(<br>    input_data=m15.data,<br>    features=m3.data,<br>    date_col=’date’,<br>    instrument_col=’instrument’,<br>    drop_na=True,<br>    remove_extra_columns=False<br>)</p>
<p>m14 = M.standardlize.v8(<br>    input_1=m16.data,<br>    input_2=m3.data,<br>    columns_input=’[]’<br>)</p>
<p>m7 = M.join.v3(<br>    data1=m13.data,<br>    data2=m14.data,<br>    on=’date,instrument’,<br>    how=’inner’,<br>    sort=False<br>)</p>
<p>m28 = M.chinaa_stock_filter.v1(<br>    input_data=m7.data,<br>    index_constituent_cond=[‘全部’],<br>    board_cond=[‘全部’],<br>    industry_cond=[‘全部’],<br>    st_cond=[‘全部’],<br>    delist_cond=[‘全部’],<br>    output_left_data=False<br>)</p>
<p>m26 = M.dl_convert_to_bin.v2(<br>    input_data=m28.data,<br>    features=m3.data,<br>    window_size=5,<br>    feature_clip=5,<br>    flatten=True,<br>    window_along_col=’instrument’<br>)</p>
<p>m4 = M.cached.v3(<br>    input_1=m26.data,<br>    input_2=m3.data,<br>    run=m4_run_bigquant_run,<br>    post_run=m4_post_run_bigquant_run,<br>    input_ports=’’,<br>    params=’{}’,<br>    output_ports=’’<br>)</p>
<p>m9 = M.instruments.v2(<br>    start_date=T.live_run_param(‘trading_date’, ‘2021-05-01’),<br>    end_date=T.live_run_param(‘trading_date’, ‘2021-09-20’),<br>    market=’CN_STOCK_A’,<br>    instrument_list=’’,<br>    max_count=0<br>)</p>
<p>m17 = M.general_feature_extractor.v7(<br>    instruments=m9.data,<br>    features=m3.data,<br>    start_date=’’,<br>    end_date=’’,<br>    before_start_days=30<br>)</p>
<p>m18 = M.derived_feature_extractor.v3(<br>    input_data=m17.data,<br>    features=m3.data,<br>    date_col=’date’,<br>    instrument_col=’instrument’,<br>    drop_na=True,<br>    remove_extra_columns=False<br>)</p>
<p>m25 = M.standardlize.v8(<br>    input_1=m18.data,<br>    input_2=m3.data,<br>    columns_input=’[]’<br>)</p>
<p>m23 = M.chinaa_stock_filter.v1(<br>    input_data=m25.data,<br>    index_constituent_cond=[‘全部’],<br>    board_cond=[‘全部’],<br>    industry_cond=[‘全部’],<br>    st_cond=[‘全部’],<br>    delist_cond=[‘全部’],<br>    output_left_data=False<br>)</p>
<p>m27 = M.dl_convert_to_bin.v2(<br>    input_data=m23.data,<br>    features=m3.data,<br>    window_size=5,<br>    feature_clip=5,<br>    flatten=True,<br>    window_along_col=’instrument’<br>)</p>
<p>m8 = M.cached.v3(<br>    input_1=m27.data,<br>    input_2=m3.data,<br>    run=m8_run_bigquant_run,<br>    post_run=m8_post_run_bigquant_run,<br>    input_ports=’’,<br>    params=’{}’,<br>    output_ports=’’<br>)</p>
<p>m6 = M.dl_layer_input.v1(<br>    shape=’21,5’,<br>    batch_shape=’’,<br>    dtype=’float32’,<br>    sparse=False,<br>    name=’’<br>)</p>
<p>m10 = M.dl_layer_lstm.v1(<br>    inputs=m6.data,<br>    units=32,<br>    activation=’relu’,<br>    recurrent_activation=’hard_sigmoid’,<br>    use_bias=True,<br>    kernel_initializer=’glorot_uniform’,<br>    recurrent_initializer=’Orthogonal’,<br>    bias_initializer=’Zeros’,<br>    unit_forget_bias=True,<br>    kernel_regularizer=’None’,<br>    kernel_regularizer_l1=0,<br>    kernel_regularizer_l2=0,<br>    recurrent_regularizer=’None’,<br>    recurrent_regularizer_l1=0,<br>    recurrent_regularizer_l2=0,<br>    bias_regularizer=’None’,<br>    bias_regularizer_l1=0,<br>    bias_regularizer_l2=0,<br>    activity_regularizer=’None’,<br>    activity_regularizer_l1=0,<br>    activity_regularizer_l2=0,<br>    kernel_constraint=’None’,<br>    recurrent_constraint=’None’,<br>    bias_constraint=’None’,<br>    dropout=0,<br>    recurrent_dropout=0,<br>    return_sequences=False,<br>    implementation=’0’,<br>    name=’’<br>)</p>
<p>m12 = M.dl_layer_dropout.v1(<br>    inputs=m10.data,<br>    rate=0.2,<br>    noise_shape=’’,<br>    name=’’<br>)</p>
<p>m20 = M.dl_layer_dense.v1(<br>    inputs=m12.data,<br>    units=30,<br>    activation=’tanh’,<br>    use_bias=True,<br>    kernel_initializer=’glorot_uniform’,<br>    bias_initializer=’Zeros’,<br>    kernel_regularizer=’None’,<br>    kernel_regularizer_l1=0,<br>    kernel_regularizer_l2=0,<br>    bias_regularizer=’None’,<br>    bias_regularizer_l1=0,<br>    bias_regularizer_l2=0,<br>    activity_regularizer=’None’,<br>    activity_regularizer_l1=0,<br>    activity_regularizer_l2=0,<br>    kernel_constraint=’None’,<br>    bias_constraint=’None’,<br>    name=’’<br>)</p>
<p>m21 = M.dl_layer_dropout.v1(<br>    inputs=m20.data,<br>    rate=0.2,<br>    noise_shape=’’,<br>    name=’’<br>)</p>
<p>m22 = M.dl_layer_dense.v1(<br>    inputs=m21.data,<br>    units=1,<br>    activation=’tanh’,<br>    use_bias=True,<br>    kernel_initializer=’glorot_uniform’,<br>    bias_initializer=’Zeros’,<br>    kernel_regularizer=’None’,<br>    kernel_regularizer_l1=0,<br>    kernel_regularizer_l2=0,<br>    bias_regularizer=’None’,<br>    bias_regularizer_l1=0,<br>    bias_regularizer_l2=0,<br>    activity_regularizer=’None’,<br>    activity_regularizer_l1=0,<br>    activity_regularizer_l2=0,<br>    kernel_constraint=’None’,<br>    bias_constraint=’None’,<br>    name=’’<br>)</p>
<p>m34 = M.dl_model_init.v1(<br>    inputs=m6.data,<br>    outputs=m22.data<br>)</p>
<p>m5 = M.dl_model_train.v1(<br>    input_model=m34.data,<br>    training_data=m4.data_1,<br>    optimizer=’Adam’,<br>    loss=’mean_squared_error’,<br>    metrics=’mae’,<br>    batch_size=256,<br>    epochs=5,<br>    custom_objects=m5_custom_objects_bigquant_run,<br>    n_gpus=0,<br>    verbose=’2:每个epoch输出一行记录’<br>)</p>
<p>m11 = M.dl_model_predict.v1(<br>    trained_model=m5.data,<br>    input_data=m8.data_1,<br>    batch_size=1024,<br>    n_gpus=0,<br>    verbose=’2:每个epoch输出一行记录’<br>)</p>
<p>m24 = M.cached.v3(<br>    input_1=m11.data,<br>    input_2=m18.data,<br>    run=m24_run_bigquant_run,<br>    post_run=m24_post_run_bigquant_run,<br>    input_ports=’’,<br>    params=’{}’,<br>    output_ports=’’<br>)</p>
<p>m19 = M.trade.v4(<br>    instruments=m9.data,<br>    options_data=m24.data_1,<br>    start_date=’’,<br>    end_date=’’,<br>    initialize=m19_initialize_bigquant_run,<br>    handle_data=m19_handle_data_bigquant_run,<br>    prepare=m19_prepare_bigquant_run,<br>    volume_limit=0.025,<br>    order_price_field_buy=’open’,<br>    order_price_field_sell=’close’,<br>    capital_base=1000000,<br>    auto_cancel_non_tradable_orders=True,<br>    data_frequency=’daily’,<br>    price_type=’真实价格’,<br>    product_type=’股票’,<br>    plot_charts=True,<br>    backtest_only=False,<br>    benchmark=’000300.SHA’<br>)</p>
<p>m29 = M.df_to_csv.v2(<br>    input_1=m19.raw_perf,<br>    name=’lstm-dnn.csv’<br>)</p>


  
</article>

              </div>
            </div>
          </div>
        </div>
      </div>
    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>

<!-- SCRIPTS -->

  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  







  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js" ></script>






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    (function () {
      var path = "/local-search.xml";
      $('#local-search-input').on('click', function() {
        searchFunc(path, 'local-search-input', 'local-search-result');
      });
      $('#modalSearch').on('shown.bs.modal', function() {
        $('#local-search-input').focus();
      });
    })()
  </script>















<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>



</body>
</html>
